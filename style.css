@import url('https://fonts.googleapis.com/css2?family=VT323&display=swap');

:root {
    --p-pink: #ff85c2;
    --p-dark: #ff4d94;
    --p-white: #fffaff;
    --p-black: #000000;
}

body { 
    margin: 0; background: #1a1a1a; display: flex; justify-content: center; 
    align-items: center; height: 100vh; font-family: 'VT323', monospace; overflow: hidden; 
}

#phone { 
    width: 360px; height: 640px; background: var(--p-white); 
    border: 8px solid var(--p-black); position: relative; overflow: hidden;
    box-shadow: 0 20px 0 #000;
}

.screen { display: none; flex-direction: column; align-items: center; justify-content: center; height: 100%; text-align: center; }
.active { display: flex; }

#wrong-overlay, #tutorial-overlay, #overlay { 
    position: absolute; inset: 0; display: flex; justify-content: center; 
    align-items: center; z-index: 200; 
}
#wrong-overlay { background: rgba(255, 0, 0, 0.4); }
#tutorial-overlay { background: rgba(0, 0, 0, 0.7); }
#overlay { background: rgba(0, 0, 0, 0.9); z-index: 300; }

.pixel-popup { 
    background: white; border: 6px solid var(--p-black); padding: 25px; 
    box-shadow: 8px 8px 0 var(--p-black); text-align: center; font-size: 28px; width: 70%; 
}

.pixel-avatar { font-size: 80px; margin-bottom: 10px; }
.pixel-header { font-size: 42px; color: var(--p-dark); margin: 0; text-shadow: 3px 3px 0 var(--p-black); }
.pixel-text { font-size: 22px; color: #333; padding: 0 20px; }
.pixel-menu { display: flex; flex-direction: column; width: 75%; gap: 12px; margin-top: 20px; }

.menu-item { 
    font-family: 'VT323', monospace; font-size: 26px; border: 4px solid var(--p-black); 
    padding: 12px; cursor: pointer; background: #fff; box-shadow: 4px 4px 0px var(--p-black); 
}
.menu-item.main { background: var(--p-pink); color: #fff; }
.menu-item.alt { background: #eee; }

.pixel-timeline { 
    position: absolute; top: 25px; width: 85%; z-index: 20; 
    padding: 10px; background: #fff; border: 4px solid var(--p-black); 
}
.nodes-container { display: flex; justify-content: space-between; }
.pixel-node { 
    width: 40px; height: 40px; background: #fff; border: 3px solid var(--p-black); 
    position: relative; overflow: hidden; display: flex; align-items: center; justify-content: center; z-index: 1;
}
.p-liquid { 
    position: absolute; bottom: 0; left: 0; width: 100%; height: 0%; 
    background: var(--p-dark); transition: height 0.3s steps(4); z-index: 2; 
}
.pixel-node span { position: relative; z-index: 3; font-size: 20px; pointer-events: none; color: #000; }

#game-canvas { width: 100%; height: 100%; position: relative; }
.heart { position: absolute; font-size: 50px; user-select: none; }

.pixel-envelope-wrap { width: 150px; height: 100px; margin: 0 auto; cursor: pointer; animation: bounce 0.8s infinite steps(2); }
.env-body { position: relative; width: 100%; height: 100%; background: #fff; border: 6px solid var(--p-black); }
.env-flap { 
    position: absolute; top: 0; left: 0; width: 0; height: 0; 
    border-left: 70px solid transparent; border-right: 70px solid transparent; border-top: 50px solid var(--p-black); 
}
.env-flap::after { 
    content: ''; position: absolute; top: -50px; left: -64px; width: 0; height: 0; 
    border-left: 64px solid transparent; border-right: 64px solid transparent; border-top: 45px solid #fff; 
}
.env-seal { position: absolute; bottom: 10px; left: 50%; transform: translateX(-50%); color: var(--p-dark); font-size: 30px; }

.pixel-card { width: 90%; display: flex; flex-direction: column; align-items: center; }
.pixel-letter-bg { 
    background: white !important; border: 6px solid var(--p-black); padding: 25px; 
    margin-bottom: 20px; box-shadow: 8px 8px 0px var(--p-pink); width: 100%; box-sizing: border-box;
}
#msg-text { font-size: 28px; color: var(--p-black); margin: 0; line-height: 1.2; text-transform: uppercase; }

.pixel-mute {
    position: absolute; bottom: 20px; right: 20px; width: 45px; height: 45px;
    background: #fff; border: 3px solid #000; box-shadow: 3px 3px 0px #000;
    cursor: pointer; z-index: 1000; display: flex; align-items: center; justify-content: center; font-size: 20px;
}

@keyframes bounce { 0%, 100% {transform: translateY(0)} 50% {transform: translateY(-20px)} }
@keyframes tapMove { 0% { transform: scale(1); } 100% { transform: scale(1.2) translateY(-10px); } }
.pixel-hand { font-size: 50px; animation: tapMove 0.6s infinite steps(2); margin-bottom: 10px; }
.shake { animation: shake 0.2s steps(2); }
@keyframes shake { 0%, 100% {transform: translateX(0)} 25% {transform: translateX(-8px)} 75% {transform: translateX(8px)} }
.hidden { display: none !important; }